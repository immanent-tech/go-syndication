// Package opengraph provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.5.0 DO NOT EDIT.
package opengraph

import (
	"encoding/json"
	"fmt"
)

// Audio is a URL to an audio file to accompany this object.
type Audio = string

// Description is a one to two sentence description of your object.
type Description = string

// Image is an image URL which should represent your object within the graph.
type Image = string

// Locale is the locale these tags are marked up in. Of the format language_TERRITORY. Default is en_US.
type Locale = string

// ObjectType is the type of your object, e.g., "video.movie". Depending on the type you specify, other properties may also be required.
type ObjectType = string

// OpenGraph is an object containing all opengraph metadata.
type OpenGraph struct {
	// Audio is a URL to an audio file to accompany this object.
	Audio *Audio `json:"audio,omitempty" validate:"omitempty,url"`

	// Description is a one to two sentence description of your object.
	Description *Description `json:"description,omitempty"`

	// Image is an image URL which should represent your object within the graph.
	Image Image `json:"image" validate:"required,url"`

	// Locale is the locale these tags are marked up in. Of the format language_TERRITORY. Default is en_US.
	Locale *Locale `json:"locale,omitempty"`

	// ObjectType is the type of your object, e.g., "video.movie". Depending on the type you specify, other properties may also be required.
	ObjectType ObjectType `json:"object_type" validate:"required"`

	// SiteName is a value that when your object is part of a larger web site, the name which should be displayed for the overall site.
	SiteName *SiteName `json:"site_name,omitempty"`

	// Title is title of your object as it should appear within the graph, e.g., "The Rock".
	Title Title `json:"title" validate:"required"`

	// URL is the canonical URL of your object that will be used as its permanent ID in the graph, e.g., "https://www.imdb.com/title/tt0117500/".
	URL URL `json:"url" validate:"required,url"`

	// Video is a URL to a video file to accompany this object.
	Video                *Video            `json:"video,omitempty" validate:"omitempty,url"`
	AdditionalProperties map[string]string `json:"-"`
}

// SiteName is a value that when your object is part of a larger web site, the name which should be displayed for the overall site.
type SiteName = string

// Title is title of your object as it should appear within the graph, e.g., "The Rock".
type Title = string

// URL is the canonical URL of your object that will be used as its permanent ID in the graph, e.g., "https://www.imdb.com/title/tt0117500/".
type URL = string

// Video is a URL to a video file to accompany this object.
type Video = string

// Getter for additional properties for OpenGraph. Returns the specified
// element and whether it was found
func (a OpenGraph) Get(fieldName string) (value string, found bool) {
	if a.AdditionalProperties != nil {
		value, found = a.AdditionalProperties[fieldName]
	}
	return
}

// Setter for additional properties for OpenGraph
func (a *OpenGraph) Set(fieldName string, value string) {
	if a.AdditionalProperties == nil {
		a.AdditionalProperties = make(map[string]string)
	}
	a.AdditionalProperties[fieldName] = value
}

// Override default JSON handling for OpenGraph to handle AdditionalProperties
func (a *OpenGraph) UnmarshalJSON(b []byte) error {
	object := make(map[string]json.RawMessage)
	err := json.Unmarshal(b, &object)
	if err != nil {
		return err
	}

	if raw, found := object["audio"]; found {
		err = json.Unmarshal(raw, &a.Audio)
		if err != nil {
			return fmt.Errorf("error reading 'audio': %w", err)
		}
		delete(object, "audio")
	}

	if raw, found := object["description"]; found {
		err = json.Unmarshal(raw, &a.Description)
		if err != nil {
			return fmt.Errorf("error reading 'description': %w", err)
		}
		delete(object, "description")
	}

	if raw, found := object["image"]; found {
		err = json.Unmarshal(raw, &a.Image)
		if err != nil {
			return fmt.Errorf("error reading 'image': %w", err)
		}
		delete(object, "image")
	}

	if raw, found := object["locale"]; found {
		err = json.Unmarshal(raw, &a.Locale)
		if err != nil {
			return fmt.Errorf("error reading 'locale': %w", err)
		}
		delete(object, "locale")
	}

	if raw, found := object["object_type"]; found {
		err = json.Unmarshal(raw, &a.ObjectType)
		if err != nil {
			return fmt.Errorf("error reading 'object_type': %w", err)
		}
		delete(object, "object_type")
	}

	if raw, found := object["site_name"]; found {
		err = json.Unmarshal(raw, &a.SiteName)
		if err != nil {
			return fmt.Errorf("error reading 'site_name': %w", err)
		}
		delete(object, "site_name")
	}

	if raw, found := object["title"]; found {
		err = json.Unmarshal(raw, &a.Title)
		if err != nil {
			return fmt.Errorf("error reading 'title': %w", err)
		}
		delete(object, "title")
	}

	if raw, found := object["url"]; found {
		err = json.Unmarshal(raw, &a.URL)
		if err != nil {
			return fmt.Errorf("error reading 'url': %w", err)
		}
		delete(object, "url")
	}

	if raw, found := object["video"]; found {
		err = json.Unmarshal(raw, &a.Video)
		if err != nil {
			return fmt.Errorf("error reading 'video': %w", err)
		}
		delete(object, "video")
	}

	if len(object) != 0 {
		a.AdditionalProperties = make(map[string]string)
		for fieldName, fieldBuf := range object {
			var fieldVal string
			err := json.Unmarshal(fieldBuf, &fieldVal)
			if err != nil {
				return fmt.Errorf("error unmarshaling field %s: %w", fieldName, err)
			}
			a.AdditionalProperties[fieldName] = fieldVal
		}
	}
	return nil
}

// Override default JSON handling for OpenGraph to handle AdditionalProperties
func (a OpenGraph) MarshalJSON() ([]byte, error) {
	var err error
	object := make(map[string]json.RawMessage)

	if a.Audio != nil {
		object["audio"], err = json.Marshal(a.Audio)
		if err != nil {
			return nil, fmt.Errorf("error marshaling 'audio': %w", err)
		}
	}

	if a.Description != nil {
		object["description"], err = json.Marshal(a.Description)
		if err != nil {
			return nil, fmt.Errorf("error marshaling 'description': %w", err)
		}
	}

	object["image"], err = json.Marshal(a.Image)
	if err != nil {
		return nil, fmt.Errorf("error marshaling 'image': %w", err)
	}

	if a.Locale != nil {
		object["locale"], err = json.Marshal(a.Locale)
		if err != nil {
			return nil, fmt.Errorf("error marshaling 'locale': %w", err)
		}
	}

	object["object_type"], err = json.Marshal(a.ObjectType)
	if err != nil {
		return nil, fmt.Errorf("error marshaling 'object_type': %w", err)
	}

	if a.SiteName != nil {
		object["site_name"], err = json.Marshal(a.SiteName)
		if err != nil {
			return nil, fmt.Errorf("error marshaling 'site_name': %w", err)
		}
	}

	object["title"], err = json.Marshal(a.Title)
	if err != nil {
		return nil, fmt.Errorf("error marshaling 'title': %w", err)
	}

	object["url"], err = json.Marshal(a.URL)
	if err != nil {
		return nil, fmt.Errorf("error marshaling 'url': %w", err)
	}

	if a.Video != nil {
		object["video"], err = json.Marshal(a.Video)
		if err != nil {
			return nil, fmt.Errorf("error marshaling 'video': %w", err)
		}
	}

	for fieldName, field := range a.AdditionalProperties {
		object[fieldName], err = json.Marshal(field)
		if err != nil {
			return nil, fmt.Errorf("error marshaling '%s': %w", fieldName, err)
		}
	}
	return json.Marshal(object)
}
